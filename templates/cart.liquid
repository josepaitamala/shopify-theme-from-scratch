{% comment %}
    templates/cart.liquid
    Simple, clean cart page showing all line items and a checkout button.
{% endcomment %}

{{ 'cart.css' | asset_url | stylesheet_tag }}

<div class="cart-wrap">
    <div class="cart-header">
        <h1>{{ 'cart.title' | t }} ({{ cart.item_count }})</h1>
        <div>
            <a href="/" class="btn btn--muted">{{ 'cart.continue_shopping' | t }}</a>
        </div>
    </div>

    {% if cart.item_count == 0 %}
        <div class="empty-cart">
            <p>{{ 'cart.empty' | t }}</p>
            <p><a href="/collections/all" class="btn">{{ 'cart.browse_products' | t }}</a></p>
        </div>
    {% else %}
        <div class="cart-list">
            {% for item in cart.items %}
                <div class="cart-item" id="cart-item-{{ forloop.index }}">
                    <div class="cart-thumb">
                        {% if item.image %}
                            <img src="{{ item.image | img_url: '200x' }}" alt="{{ item.title }}">
                        {% elsif item.product.featured_image %}
                            <img src="{{ item.product.featured_image | img_url: '200x' }}" alt="{{ item.title }}">
                        {% else %}
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="#eee" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" rx="4"/></svg>
                        {% endif %}
                    </div>

                    <div class="cart-meta">
                        <a href="{{ item.url }}" class="cart-title">{{ item.product.title }}</a>
                        
                        {% if item.variant_title != blank %}
                            <div class="cart-variant">{{ item.variant_title }}</div>
                        {% endif %}
                        <div class="cart-actions">
                            <!-- Update quantity: uses the /cart/change endpoint with the line number -->
                            <form action="/cart/change" method="post" style="display:inline-block;">
                                <input type="hidden" name="line" value="{{ forloop.index }}">
                                <input class="qty-input" type="number" min="0" name="quantity" value="{{ item.quantity }}" aria-label="Quantity for {{ item.product.title }}">
                                <button type="submit" class="btn btn--muted" title="Update quantity">{{ 'cart.update' | t }}</button>
                            </form>

                            <!-- Remove (set quantity to 0) -->
                            <form action="/cart/change" method="post" style="display:inline-block;">
                                <input type="hidden" name="line" value="{{ forloop.index }}">
                                <input type="hidden" name="quantity" value="0">
                                <button type="submit" class="btn btn--muted" title="Remove item">{{ 'cart.remove' | t }}</button>
                            </form>
                        </div>
                    </div>

                    <div class="cart-price">
                        <div>{{ item.line_price | money }}</div>
                        <div class="cart-price">
                            <div>{{ item.line_price | money }}</div>
                            <div class="unit-price">{{ item.price | money }} each</div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="cart-summary">
            <div>
                <div>Subtotal</div>
                <div class="subtotal">{{ cart.total_price | money }}</div>
            </div>

            <div style="display:flex; gap:12px; align-items:center;">
                <a href="/collections/all" class="btn btn--muted">Continue shopping</a>
                <a href="/checkout" class="btn">Checkout</a>
            </div>
        </div>
    {% endif %}
</div>